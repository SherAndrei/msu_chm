\documentclass[12pt]{article}

%Russian-specific packages
%--------------------------------------
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english, russian]{babel}
%--------------------------------------
%for search in russian
\usepackage{cmap}

%Math-specific packages
%--------------------------------------
\usepackage{amsmath}
\usepackage{amssymb}

%Format-specific packages
%--------------------------------------
\usepackage[left=2cm,
            right=2cm,
            top=2cm,
            bottom=2cm,
            bindingoffset=0cm]{geometry}
%--------------------------------------

\usepackage{amsthm}

\newtheorem*{definition}{Определение}
\newtheorem*{theorem}{Теорема}

%Roman enum items
\usepackage{enumerate}

\def\bigO{ \underline{\underline{\mathcal{O}}} }

\begin{document}
    \begin{center}
    Численное решение дифференциального уравнения второго порядка. Отчет.
    \end{center}
    \begin{center}
    Шерстобитов Андрей, задача 4
    \end{center}
    Общая постановка задачи:
    \[\begin{cases}
        -y''(x) +p(x)y(x) = f(x),\ p(x) \geq 0\\
        y(0) = 0 \\
        y'(1) = 0
    \end{cases}\]
    Предлагается исследовать разностную схему вида
    \[\begin{cases}
        -\frac{y_{k+1}-2y_k+y_{k-1}}{h^2}+p_ky_k = f_k,\ h = \frac{2}{2N-1},\ 1 \leq k \leq N-1 \\
        f_k := f(x_k),\ p_k := p(x_k) \\
        y_0 = 0 \\
        y_N = y_{N-1}
    \end{cases}\]
    Запишем канонический вид. Найдем коэффициенты для краевых условий
    \begin{align*}
        k &= 1: \frac{y_2 - 2y_1}{h^2} + p_1y_1= f_1 \\
        k &= N-1: \frac{-y_{N-1} + y_{N-2}}{h^2} + p_{N-1} y_{N-1} = f_{N-1}
    \end{align*}
    Задача в матричном виде имеет вид:
    \[
    -\left(\begin{array}{cccccc}
        \frac{-2}{h^2}& \frac{1}{h^2}  &&&& 0 \\
        \frac{1}{h^2} & \frac{-2}{h^2} & \frac{1}{h^2} &&& \\
        &&\cdots&\cdots&& \\
        &&& \frac{1}{h^2} & \frac{-2}{h^2} & \frac{1}{h^2} \\
        0 &&&               & \frac{1}{h^2}  & \frac{-1}{h^2} \\
    \end{array}\right)
    \left(\begin{array}{c}
        y_{1}\\
        \\
        \vdots\\
        \\
        y_{N-1}\\
    \end{array}\right)
    +
    \left(\begin{array}{ccc}
        p_1  && 0 \\
        && \\
        &\ddots& \\
        && \\
        0 && p_{N-1} \\
    \end{array}\right)
    \left(\begin{array}{c}
        y_{1}\\
        \\
        \vdots\\
        \\
        y_{N-1}\\
    \end{array}\right)
    =
    \left(\begin{array}{c}
        f_{1}\\
        \\
        \vdots\\
        \\
        f_{N-1}\\
    \end{array}\right)
    \]
    Будем использовать сеточную интегральную норму
    \[\Vert y_h\Vert^2_h = (y_h,y_h)_h= \sum_{k=1}^{N-1}y^2_kh\]
    согласованной с нормой $\Vert y(x)\Vert^2_{L^2(0,1)} = \int_0^1y^2(x)dx$ исходной задачи.

    План:
    \begin{enumerate}[I.]
        \item Доказать, что разностная схема имеет порядок аппроксимации $O(h^2)$.
        \item Доказать устойчивость разностный схемы.
        \item Доказать, что есть сходимость $O(h^2)$.
        \item Исследовать применимость метода Фурье при $p \equiv const$ и метода прогонки/
        \item Показать, что сходимость численно действительно $O(h^2)$ либо иначе.
    \end{enumerate}

    \newpage

    \begin{enumerate}[I.]
        \item Докажем аппроксимацию второго порядка на решении:
        \begin{enumerate}
            \item $\Vert L_h(u)_{U_h}-f_h\Vert_{F_h}\leq\bigO(h^2)$
            \[\max_{x_k}\left|-\frac{y(x_k+h)-2y(x_k)+y(x_k-h)}{h^2}+p(x_k)y(x_k)-f(x_k)\right|=\]
            \[y(x_k\pm h)=y(x_k)\pm hy(x_k)\frac{h^2}{2}y''(x_k)\pm\frac{h^3}{6}y'''(x_k)+\bigO(h^4)\]
            \[=\max_{x_k}\left|-\frac{h^2y''(x_k)+\bigO(h^4)}{h^2}+p(x_k)y(x_k)-f(x_k)\right|=\]
            \[=\max_{x_k}\left|-y''(x_k)+\bigO(h^2)+p(x_k)y(x_k)-f(x_k)\right|=\bigO(h^2)\]
            \item $\Vert l_h(u)_{U_h}-\varphi_h\Vert_{\Phi_h}\leq\bigO(h^2)$
            \begin{enumerate}
                \item $y_0 = 0$ TODO
                \item $y_N = y_{N-1}$ TODO
            \end{enumerate}
            \item Условия нормировки
            \[\lim_{h\rightarrow0}\Vert f_h-(f)_{F_h}\Vert_{F_h}=0;\ \lim_{h\rightarrow0}\Vert \varphi_h-(\varphi)_{\Phi_h}\Vert_{\Phi_h}=0\]
        \end{enumerate}

        \newpage

        \item Напомним определение устойчивости разностной схемы.
        \begin{definition}
            Пусть уравнение $y''(x)=f(x)$ доопределено краевыми
            условиями на разных концах отрезка. Разностная схема
            $A_hy_h = f_h$ линейной задачи устойчива, если существуют $C$, $h_0$ такие, что для
            произвольных $A_hy^{(1,2)}_h = f^{(1,2)}_h$ выполняется оценка
            \[\Vert y^{(1)}_h-y^{(2)}_h\Vert_h\leq C\Vert f^{(1)}_h -f^{(2)}_h\Vert_h\ \forall h\leq h_0\]
            с константой $C$, не зависящей от $h$.
        \end{definition}

        Будем доказывать устойчивость разностной схемы энергетическим методом.
        Запишем нашу дифференциалную задачу
        \[-y''(x)+p(x)y(x)=f(x),\ y(0) = y'(1) = 0,\ p(x)\geq 0\]
        Умножим уравнение на $y(x)$, и результат проинтегрируем по отрезку $[0, 1]$
        \[\int_0^1 (-y''y+py^2)dx = \int_0^1fydx \]
        \[\int_0^1 -y''ydx+ \int_0^1py^2 dx = \int_0^1fydx \]
        Проинтегрируем по частям первое слагаемое
        \[\int_0^1 -y''ydx = \int_0^1-ydy' = -yy'\vert^1_0 - \int_0^1y'd(-y) = \int_0^1(y')^2dx\]
        Получили интегральное тождество
        \[\int_0^1 (y'(x))^2dx+ \int_0^1py^2 dx = \int_0^1fydx \]
        Оценим слева через неравенство, связывающее интегралы от квадратов
        функции и ее производной. Так как $y(0) = 0$, то справедливо следующее:
        \[y(x_0) = \int_0^{x_0}y'(x)dx\]
        Применим интегральную форму неравенства Коши-Буняковского:
        \[|y(x_0)|^2 = \left|\int_0^{x_0}y'dx\right|^2\leq\left(\int_0^{x_0}1^2dx\right)\left(\int_0^{x_0}(y')^2dx\right)\leq\int_0^{x_0}(y')^2dx\leq\int_0^{1}(y')^2dx\]
        После интегрирования по $x_0$ по отрезку $[0,1]$ обеих частей получим искомое равенство
        \[\int_0^1|y(x_0)|^2dx_0 \leq \int_0^{1}(y')^2dx\int_0^1dx_0 \Leftrightarrow \int_0^1y^2dx\leq\int_0^1(y')^2dx\]
        Оценку справа выведем из разности квадратов:
        \[0\leq\left(\int_0^1fdx-\int_0^1ydx\right)^2\leq\left(\int_0^1fdx\right)^2-2\int_0^1fydx+\left(\int_0^1ydx\right)^2\]
        \[\Rightarrow\int_0^1fydx\leq\frac{1}{2}\left(\int_0^1f^2dx + \int_0^1y^2dx\right)\]

        Таким образом имеем:
        \[\int_0^1y^2dx\leq\int_0^1 (y'(x))^2dx+ \int_0^1py^2 dx = \int_0^1fydx\leq\frac{1}{2}\left(\int_0^1f^2dx + \int_0^1y^2dx\right)\]
        Таким образом верна оценка
        \[\int_0^1y^2dx\leq\int_0^1f^2dx\Rightarrow\Vert y\Vert_{L_2(0,1)}\leq\Vert f\Vert_{L_2(0,1)}\]
        Это означает устойчивость дифференциальной задачи по правой части.

        Докажем теперь устойчивость разностной схемы.
        \[-\frac{y_{k+1}-2y_k+y_{k-1}}{h^2}+p_ky_k = f_k,\ 1 \leq k \leq N-1,\ y_0 = 0,\ y_N = y_{N-1}\]
        Умножим на $y_k$ и просуммируем от $1$ до $N-1$. Так как $y_0 = 0,\ y_N = y_{N-1}$
        \[-\frac{1}{h^2}\left(\sum_{k=1}^{N-1}\left(y_{k+1}-2y_k+y_{k-1}\right)y_k\right)=-\frac{1}{h^2}\left(\sum_{k=1}^{N-1}\left(y_{k+1}-y_k-y_k+y_{k-1}\right)y_k\right)=\]
        \[=-\frac{1}{h^2}\sum_{k=1}^{N-1}\left(y_{k+1}-y_k\right)y_k+\frac{1}{h^2}\sum_{k=1}^{N-1}\left(y_k-y_{k-1}\right)y_k=\]
        \[=-\frac{1}{h^2}\sum_{k=2}^{N}\left(y_{k}-y_{k-1}\right)y_{k-1}+\frac{1}{h^2}\sum_{k=1}^{N-1}\left(y_k-y_{k-1}\right)y_k=\frac{1}{h^2}\sum_{k=1}^{N}(y_k-y_{k-1})^2\]
        Получили конечномерный аналог интегрального тождества:
        \[\frac{1}{h^2}\sum_{k=1}^N(y_k-y_{k-1})^2+\sum_{k=1}^{N-1}p_ky_k^2=\sum_{k=1}^{N-1}f_ky_k\]
        Для оценки слева докажем сеточный аналог неравенства для функции и ее производной в точках $k=1,...,N-1$.
        Так как $y_0 = 0$, справедливо следующее:
        \[y_k=\sum_{i=1}^{k}(y_i-y_{i-1})\]
        Воспользуемся неравенством Коши-Буняковского и $y_N=y_{N-1}$
        \[y_k^2\leq\left(\sum_{i=1}^k1^2\right)\left(\sum_{i=1}^k(y_i-y_{i-1})^2\right)\leq (N-1)\sum_{i=1}^{N-1}(y_i-y_{i-1})^2\]
        Суммируя до $N-1$ обе части, при $h=\frac{2}{2(N-1)}$ получаем оценку:
        \[\sum_{k=1}^{N-1}y_k^2\leq(N-1)^2\sum_{k=1}^{N-1}(y_k-y_{k-1})^2\leq\frac{1}{h^2}\sum_{k=1}^{N-1}(y_k-y_{k-1})^2\]
        Найдем аналогично дифференциальному неравенству оценку справа
        \[0\leq\left(\sum_{k=1}^{N-1}f_k-\sum_{k=1}^{N-1}y_k\right)^2\leq\left(\sum_{k=1}^{N-1}f_k\right)^2-2\sum_{k=1}^{N-1}f_ky_k+\left(\sum_{k=1}^{N-1}y_k\right)^2\]
        \[\Rightarrow\sum_{k=1}^{N-1}f_ky_k\leq\frac{1}{2}\left(\sum_{k=1}^{N-1}f_k^2+\sum_{k=1}^{N-1}y_k^2\right)\]
        Итоговая оценка имеет вид
        \[\sum_{k=1}^{N-1}y_k^2\leq\frac{1}{h^2}\sum_{k=1}^{N-1}(y_k-y_{k-1})^2+\sum_{k=1}^{N-1}p_ky_k^2=\sum_{k=1}^{N-1}f_ky_k\leq\frac{1}{2}\left(\sum_{k=1}^{N-1}f_k^2+\sum_{k=1}^{N-1}y_k^2\right)\]
        Таким образом
        \[\sum_{k=1}^{N-1}y_k^2\leq\sum_{k=1}^{N-1}f_k^2\Rightarrow\sum_{k=1}^{N-1}y_k^2h\leq\sum_{k=1}^{N-1}f_k^2h\Rightarrow\Vert y_h\Vert^2_h\leq\Vert f_h\Vert^2_h\]
        Устойчивость разностной схемы доказана.
        \newpage
        \item Докажем, что у схемы есть сходимость порядка $\bigO(h^2)$.
        \begin{theorem}[Филиппов А.Ф.]
            Пусть выполнены следюущие условия:
            \begin{enumerate}
                \item операторы $L$, $l$ и $L^h$, $l^h$ - линейные;
                \item решение дифференциальной задачи $\exists!$;
                \item разностная схема аппроксимирует на решении дифференциальную задачу с порядком $p$;
                \item разностная схема устойчива;
            \end{enumerate}
            Тогда решение разностной схемы сходится к решению дифференциальной задачи с порядком не ниже $p$
        \end{theorem}
        Посмотрим на наши результаты
        \begin{enumerate}
            \item операторы $L$, $l$ и $L^h$, $l^h$ - действительно линейные;
            \item решение дифференциальной задачи $\exists!$, так как по условию $y$ и $f$ хорошие гладкие функции.
            \item разностная схема аппроксимирует на решении дифференциальную задачу с порядком $2$;
            \item разностная схема устойчива;
        \end{enumerate}
        Таким образом решение разностной схемы сходится к решению дифференциальной задачи с порядком не ниже $2$.
    \end{enumerate}
\end{document}
